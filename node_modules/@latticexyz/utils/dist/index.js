function Ir(r){return r.length!==0}function vr(r){return r.filter(e=>e!=null)}function p(){let r=null,e=null,t=new Promise((o,n)=>{r=i=>o(i),e=i=>n(i)});return[r,e,t]}import{reaction as G}from"mobx";async function R(r){let[e,,t]=p(),o=G(()=>r.get(),i=>{i&&e(i)},{fireImmediately:!0}),n=await t;return o(),n}function B(r){return typeof r=="object"&&!Array.isArray(r)&&r!==null}function O(r){return r instanceof Function}import{reaction as q}from"mobx";import Q from"proxy-deep";function S(r,e){if(e.length===0)return r;if(e.length===1)return r[e[0]];let[t,...o]=e,n=r[t];if(!B(n))throw new Error("Path does not exist on the target");return S(n,o)}function $r(r){let e=[],t=new Q({},{get(o,n){let i=r.get();return i?n==="proxied"?!1:Reflect.get(i,n):n==="proxied"?!0:n==="name"?"ProxiedTarget":n==="toJSON"?()=>({proxied:!0}):this.nest(()=>{})},apply(o,n,i){let s=r.get();if(s){let a=S(s,this.path);if(!O(a))throw new Error("Target is not callable");return Reflect.apply(a,n,i)}else{let[a,l,u]=p();return e.push({path:this.path,args:i,resolve:a,reject:l}),u}}});return q(()=>r.get(),o=>{if(!o)return;let n=e.splice(0);for(let{path:i,args:s,resolve:a,reject:l}of n){let u=S(o,i);s&&O(u)?(async()=>{try{a(await u(...s))}catch(f){l(f)}})():a(u)}}),t}function Yr(r){let e=[];for(let t of Object.values(r))isNaN(Number(t))||e.push(Number(t));return e}function Jr(r,e){let t={};for(let o in r)t[o]=e(r[o],o);return t}function Z(r,e=0){return Math.floor(Math.random()*(r-e+1))+e}function Xr(r){return r[Z(r.length-1)]}import{concatMap as rr,delay as er,filter as tr,first as or,mergeMap as nr,of as ir,pipe as E,ReplaySubject as F,scan as ar,timestamp as sr}from"rxjs";import{computed as U,observable as P,reaction as _,runInAction as j,toJS as ur}from"mobx";function lr(){return E(tr(r=>r!=null))}function oe(){return E(rr(r=>r))}function ne(r){return E(sr(),ar((e,t)=>{let o=0;if(e!==null){let n=t.timestamp-e.timestamp;o=n>r?0:r-n}return{timestamp:t.timestamp,delay:o,value:t.value}},null),lr(),nr(e=>ir(e.value).pipe(er(e.delay)),1))}function ie(r){return U(()=>r.get())}function ae(r){let e=new F(1);return _(()=>r.get(),t=>{t!=null&&e.next(t)},{fireImmediately:!0}),e}function se(r){let e=new F(1);return _(()=>ur(r),t=>{t!=null&&e.next(t)},{fireImmediately:!0}),e}function ue(r){let e=P.box();return r.subscribe(t=>j(()=>e.set(t))),U(()=>e.get())}async function le(r){let e=P.box();r.subscribe(o=>j(()=>e.set(o)));let t=U(()=>e.get());return await R(t),t}async function cr(r,e=t=>t!=null){let[t,,o]=p();return r.pipe(or(e)).subscribe(t),o}async function ce(r){let e={};return r.subscribe(t=>e.current=t),e.current=await cr(r),e}var fe=function(){let r=mr,e=fr;return e(r(32),8)+"-"+e(r(16),4)+"-"+e(16384|r(12),4)+"-"+e(32768|r(14),4)+"-"+e(r(48),12)},mr=function(r){if(r<0||r>53)return NaN;let e=0|Math.random()*1073741824;return r>30?e+(0|Math.random()*(1<<r-30))*1073741824:e>>>30-r},fr=function(r,e){let t=r.toString(16),o=e-t.length,n="0";for(;o>0;o>>>=1,n+=n)o&1&&(t=n+t);return t};function M(r,e){return new Promise(t=>setTimeout(()=>t(e),r))}var be=function*(r=0,e=1,t=0){for(let o=0;o<r;yield t+o++*e);};async function pr(r,e){throw await M(r),new Error(e)}var ge=async(r,e,t)=>Promise.race([r,pr(e,t)]),ye=(r,e=[],t=10,o=1e3)=>{let[n,i,s]=p();return(async()=>{let l;for(let u=0;u<t;u++)try{l=await r(...e),n(l);break}catch(f){u<t-1?(console.info("[CallWithRetry Failed] attempt number="+u,r),console.error(f),await M(Math.min(o*2**u+Math.random()*100,15e3))):i(f)}})(),s};function y(r){return{...r,[Symbol.iterator](){return this}}}function Ae(r,e){return y(e?{next(){let t=r.next();return t.done?e.next():t}}:r)}function we(r,e){return y({next(){let o=r.next(),n=e.next();return o.done&&n.done?{done:!0,value:null}:{value:[o.value,n.value]}}})}function I(r,e){return y({next(){let{done:t,value:o}=r.next();return{done:t,value:t?o:e(o)}}})}function Ce(r){let e=0;return y({next(){let o=e>=r.length;return o?{done:o,value:null}:{value:r[e++]}}})}function ve(r,e){return e.x>=r.x&&e.y>=r.y&&e.x<r.x+r.width&&e.y<r.y+r.height}function ke(r){let e=[];for(let t=0;t<r.width;t++)for(let o=0;o<r.height;o++)e.push({x:r.x+t,y:r.y+o});return e}import{BigNumber as dr}from"ethers";import{keccak256 as $,toUtf8Bytes as xr}from"ethers/lib/utils.js";import{defaultAbiCoder as Tr}from"ethers/lib/utils.js";function Ue(r){return dr.from($(xr(r))).toHexString()}function Me(r){let e=Tr.encode(["int32","int32"],[r.x,r.y]);return $(e)}import{fromEvent as D,map as Y}from"rxjs";function Fe(r,e){return e.subscribe(t=>r.postMessage(t)),D(r,"message").pipe(Y(t=>t.data))}function Pe(r){let e=D(self,"message");r.work(e.pipe(Y(o=>o.data))).subscribe(o=>self.postMessage(o))}function br(r,e){return r&2**e-1}function gr(r,e){if(e.reduce((o,n)=>o+n,0)>32)throw new Error("JS pretends integers are 32 bit when bitshifts are involved");if(r.length!==e.length)throw new Error("Arrays' lengths must match");for(let o=0;o<r.length;o++){if(r[o]<0)throw new Error("Underflow: can only pack unsigned integer");if(r[o]>2**e[o]-1){let n=`Overflow: ${r[o]} does not fit in ${e[o]} bits`;throw new Error(n)}}let t=0;for(let o=0;o<r.length;o++)t=t<<e[o]|r[o];return t}function yr(r,e){let t=[],o=r;for(let n=e.length-1;n>=0;n--)t.unshift(br(o,e[n])),o=o>>>e[n];return t}function je(r){return gr(r,[8,24])}function $e(r){return yr(r,[8,24])}var hr=2**16-1,h=2**15-1;function We(r,e){let t=new A;for(let o of r.coords())e.get(o)||t.set(o,!0);return t}function v(r){return r.x<<16|r.y&hr}function W(r){let e=r>>16,t=r<<16>>16;return{x:e,y:t}}var A=class{map;defaultValue;constructor(e){this.map=new Map,this.defaultValue=e?.defaultValue}static from(e){let t=new A;return t.map=e.map,t.defaultValue=e.defaultValue,t}set(e,t){if(e.x>h||e.x<-1*h||e.y>h||e.y<-1*h)throw new Error(`CoordMap only supports coords up to ${h}`);return this.map.set(v(e),t)}get(e){return this.map.get(v(e))??this.defaultValue}keys(){return this.map.keys()}coords(){return I(this.map.keys(),e=>W(e))}entries(){return this.map.entries()}toArray(){return Array.from(this.map.entries()).map(([t,o])=>[W(t),o])}values(){return this.map.values()}delete(e){return this.map.delete(v(e))}has(e){return this.map.has(v(e))}clear(){for(let e of this.map.keys())this.map.delete(e)}get size(){return this.map.size}};function k(r){return`${r.x}/${r.y}/${r.z}`}function J(r){let e=r.split("/");return{x:Number(e[0]),y:Number(e[1]),z:Number(e[2])}}var V=class{map;defaultValue;constructor(e){this.map=new Map,this.defaultValue=e?.defaultValue}static from(e){let t=new V;return t.map=e.map,t.defaultValue=e.defaultValue,t}set(e,t){return this.map.set(k(e),t)}get(e){return this.map.get(k(e))??this.defaultValue}keys(){return this.map.keys()}coords(){return I(this.map.keys(),e=>J(e))}entries(){return this.map.entries()}toArray(){return Array.from(this.map.entries()).map(([t,o])=>[J(t),o])}values(){return this.map.values()}delete(e){return this.map.delete(k(e))}has(e){return this.map.has(k(e))}clear(){for(let e of this.map.keys())this.map.delete(e)}get size(){return this.map.size}};function H(r,e){r.substring(0,2)=="0x"&&(r=r.substring(2));let t=e/4;return r=r.padStart(t,"0"),r=r.substring(r.length-t),`0x${r}`}function X(r){return H(r,160)}function ze(r){return H(r,256)}function Ke(r){if(r[0]!=="0"&&r[1]!=="x")throw new Error("Invalid hex string");return"0x"+r.substring(10)}function d(r,e,t){return(((e^t)*134775813^r+e)*(1103515245*e<<16^1103515245*t-134775813)>>>0)/4294967295}function m(r,e){if(r<0)for(;r<0;)r+=e;return r%e}function N(r,e,t,o,n,i,s){let a=o-t-(r-e);return(e*Math.pow(i,3)+n*(t*Math.pow(i,2)+r*i*(-i+n)+n*(-(e+a)*i+a*n)))*s}function Ge(r,e,t,o=Number.MAX_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER){return{seed:Math.floor(r*Number.MAX_SAFE_INTEGER),periodX:o,periodY:n,octave:e,scale:t}}function qe(r,e){let t=Math.floor(e),o=e-t;return N(d(r.seed,m(t-1,r.periodX),0),d(r.seed,m(t,r.periodX),0),d(r.seed,m(t+1,r.periodX),0),d(r.seed,m(t+2,r.periodX),0),o,1,1)*.666666+.166666}function Qe({octave:r,periodX:e,periodY:t,seed:o,scale:n},i,s){let a=Math.floor(i/r),l=Math.floor(i*1e3/r)-a*1e3,u=Math.floor(s/r),f=Math.floor(s*1e3/r)-u*1e3,T=m(a-1,e),c=m(a,e),b=m(a+1,e),L=m(a+2,e),g=new Array(4);for(let w=0;w<4;++w){let C=m(u-1+w,t);g[w]=N(d(o,T,C),d(o,c,C),d(o,b,C),d(o,L,C),l,1e3,1)}return Math.floor(N(g[0],g[1],g[2],g[3],f,1e3,n)/Math.pow(1e3,6))}var x="mud-logger-topics";function rt(){let r=window.console,e=!!localStorage.getItem(x),t=localStorage.getItem(x),o=t?JSON.parse(t):[];function n(...c){e||r.log(...c)}function i(c,...b){(!e||o.includes(c))&&(r.log(`--- BETTER CONSOLE / TOPIC ${c} ---`),r.log(...b))}function s(){localStorage.setItem(x,JSON.stringify([])),e=!0}function a(){localStorage.removeItem(x),e=!1}function l(c){o.push(c),localStorage.setItem(x,JSON.stringify(o))}function u(c){o=o.filter(b=>b!==c),localStorage.setItem(x,JSON.stringify(o))}function f(){o=[],localStorage.setItem(x,JSON.stringify(o))}let T={...r,log:n,logWithTopic:i,enableFilters:s,disableFilters:a,addTopic:l,removeTopic:u,resetTopics:f};return window.logger=T,window.console=T,T}function tt(r,e){if(r.length!==e.length)throw new Error("points must have same dimension");return Math.sqrt(r.reduce((t,o,n)=>t+Math.pow(r[n]-e[n],2),0))}function nt(r){return(r<0?-1:1)*Math.floor(Math.abs(r))}var at=r=>`0x${[...new Uint8Array(r)].map(e=>e.toString(16).padStart(2,"0")).join("")}`;var ut=r=>[...r].map(e=>String.fromCharCode(e)).join("");function z(r){return/^(0x)?([\da-f]{2})*$/i.test(r)}var K=r=>{if(!z(r))throw console.error("Invalid hex string",r),new Error("Invalid hex string");let e=r.match(/[\da-f]{2}/gi);return e?new Uint8Array(e.map(t=>parseInt(t,16))):new Uint8Array([])};var pt=r=>{if(r.length>16)throw new Error("string too long");return new Uint8Array(16).map((e,t)=>r.charCodeAt(t))},dt=r=>{if(r.length>32)throw new Error("string too long");return new Uint8Array(32).map((e,t)=>r.charCodeAt(t))};function Ar(r){return r.substring(0,2)=="0x"&&(r=r.substring(2)),(r.length%2!==0?"0x0":"0x")+r}function wr(r){return K(r)}function It(r){return r.length===0?"0x00":Ar(r.reduce((e,t)=>e+t.toString(16).padStart(2,"0"),""))}function vt(...r){return Uint8Array.from(r.reduce((e,t)=>[...e,...t],[]))}function kt(r,e){let t=[],o=0;for(let n of e){let i=new Uint8Array(n);t.push(i);for(let s=0;s<n;s++)i[s]=r[o],o++}return t}function Vt(r){let e=new ArrayBuffer(r.length*4),t=new Int32Array(e);for(let o=0;o<r.length;o++)t[o]=r[o];return new Uint8Array(e)}function Ot(r){return[...new Int32Array(r.buffer)]}function St(r){return wr(X(r))}function Cr(r){if(r<2)throw new Error("Minimum size is 2");if(r>64)throw new Error("Maximum size is 64");let e=2**(r-1)-1,t=-e-1;return o=>{if(o=o<<0,o>e||o<t)throw console.log("value",o,e,t,o>e,o<t),new Error(`Int${r} overflow`);return o<0?2**r+o:o}}var Et=Cr(32);export{A as CoordMap,Vt as Int32ArrayToUint8Array,It as Uint8ArrayToHexString,Ot as Uint8ArrayToInt32Array,V as VoxelCoordMap,ve as areaContains,at as arrayToHex,Ce as arrayToIterator,oe as awaitPromise,cr as awaitStreamValue,R as awaitValue,ut as bytesToString,$r as cacheUntilReady,ye as callWithRetry,ae as computedToStream,Ae as concatIterators,vt as concatUint8Arrays,v as coordToKey,ke as coordsOf,Cr as createToInt,Ge as cubicNoiseConfig,qe as cubicNoiseSample1,Qe as cubicNoiseSample2,p as deferred,rt as enableLogger,St as ethAddressToUint8Array,tt as euclidean,Ke as extractEncodedArguments,lr as filterNullish,vr as filterNullishValues,Ar as formatHex,Fe as fromWorker,wr as hexStringToUint8Array,K as hexToArray,N as interpolate,O as isFunction,z as isHex,Ir as isNotEmpty,B as isObject,Ue as keccak256,Me as keccak256Coord,W as keyToCoord,y as makeIterable,Jr as mapObject,we as mergeIterators,Yr as numValues,ie as observableToComputed,se as observableToStream,gr as pack,je as packTuple,H as padToBitLength,Xr as pickRandom,Z as random,d as randomize,be as range,pr as rejectAfter,nt as roundTowardsZero,Pe as runWorker,M as sleep,kt as splitUint8Arrays,ue as streamToComputed,le as streamToDefinedComputed,ce as streamToWrappedValue,ne as stretch,pt as stringToBytes16,dt as stringToBytes32,We as subtract,m as tile,ge as timeoutAfter,ze as to256BitString,X as toEthAddress,Et as toInt32,I as transformIterator,yr as unpack,$e as unpackTuple,fe as uuid};
/**
 * UUID.core.js - UUID.js for Minimalists
 *
 * @file
 * @author  LiosK
 * @version v4.2.0
 * @license Apache License 2.0: Copyright (c) 2010-2018 LiosK
 * @url https://github.com/LiosK/UUID.js/blob/master/src/uuid.core.js
 */
//# sourceMappingURL=index.js.map