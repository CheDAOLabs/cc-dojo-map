import{setComponent as L,Type as g}from"@dojoengine/recs";import{poseidonHashMany as z}from"micro-starknet";function st(n){return n.events.filter(t=>t.keys.length===1&&t.keys[0]==="0x1a2f334228cee715f1f0f54053bb6b5eac54fa336e0bc1aacf7516decb0471d")}function mt(n,t){t.forEach(o=>J(n,o.data))}function J(n,t){let o=U(t[0]),a=n[o],r=parseInt(t[1]),s=2+r+1,m=t.slice(2,2+r).map(l=>BigInt(l)),u=$(m),i=parseInt(t[s++]),d=m.map(l=>l.toString()),y=t.slice(s,s+i),f=P(a,[...d,...y]);L(a,u,f)}function G(n,t){switch(t){case g.Boolean:return n!=="0x0";case g.Number:return Number(n);case g.BigInt:return BigInt(n);default:return n}}function P(n,t){let o=n.schema,a=n.metadata?.types??[];return Q(o,a,t,{types:0,values:0})}function Q(n,t,o,a){return Object.keys(n).reduce((r,s)=>{let m=n[s];if(typeof m=="object")r[s]=Q(m,t,o,a);else{if(r[s]=G(o[a.values],m),a.values++,t[a.types]=="u256"){let u=G(o[a.values],m);r[s]|=u<<128n,a.values++}a.types++}return r},{})}function U(n){for(var t="",o=2;o<n.length;o+=2)t+=String.fromCharCode(parseInt(n.substr(o,2),16));return t}function $(n){return"0x"+z(n).toString(16)}function ct(n,t){t.forEach(o=>{W(n,o)})}function W(n,t){let o=t.node.keys.map(r=>BigInt(r)),a=$(o);t.node.models.forEach(r=>{let s=r.__typename,m=n[s];if(!m){console.error(`Component ${s} not found`);return}let u=Object.keys(m.schema).reduce((i,d)=>{let y=r[d],f=q(y,m.schema[d]);return i[d]=f,i},{});L(m,a,u)})}function q(n,t){if(n==null)return n;if(typeof t=="object"&&t!==null){let o={};for(let a in t)o[a]=q(n[a],t[a]);return o}switch(t){case g.Boolean:return!!n;case g.Number:return typeof n=="string"?0:isNaN(Number(n))?n:Number(n);case g.BigInt:return BigInt(n);default:return n}}function pt(n,t=6){if(n?.length<=t)return n;let o=Math.floor(t/2),a=n.slice(0,o),r=n.slice(-o);return`${a}...${r}`}import*as e from"mathjs";var c=(n,t)=>!Array.isArray(n)||!Array.isArray(t)?e.multiply(n,t):n.map((o,a)=>o*t[a]),C=n=>n.map(t=>Math.floor(t)),w=(n,t)=>n.map((o,a)=>t[a]<=o?0:1),X=n=>n.map(t=>t-Math.floor(t*(1/289))*289),_=n=>(n=n.map(t=>(t*34+1)*t),X(n)),Y=n=>n.map(t=>1.79284291400159-.85373472095314*t),Z=n=>{let t=[.16666666666666666,.3333333333333333],o=[0,.5,1,2],a=C(e.add(n,e.dot(n,[t[1],t[1],t[1]]))),r=e.add(e.subtract(n,a),e.dot(a,[t[0],t[0],t[0]])),s=w([r[1],r[2],r[0]],[r[0],r[1],r[2]]),m=e.subtract(1,s),u=e.min([[s[0],s[1],s[2]],[m[2],m[0],m[1]]],0),i=e.max([[s[0],s[1],s[2]],[m[2],m[0],m[1]]],0),d=e.add(e.subtract(r,u),[t[0],t[0],t[0]]),y=e.add(e.subtract(r,i),[t[1],t[1],t[1]]),f=e.subtract(r,[o[1],o[1],o[1]]),l=_(e.add(a[2],[0,u[2],i[2],1])),b=_(e.add(e.add(l,a[1]),[0,u[1],i[1],1])),H=_(e.add(e.add(b,a[0]),[0,u[0],i[0],1])),p=[.285714285714286,-.928571428571428,.142857142857143],M=e.subtract(H,c(49,C(c(H,p[2]*p[2])))),O=C(c(M,p[2])),K=C(e.subtract(M,c(7,O))),E=e.add(c(O,p[0]),[p[1],p[1],p[1],p[1]]),I=e.add(c(K,p[0]),[p[1],p[1],p[1],p[1]]),N=e.subtract(e.subtract(1,e.abs(E)),e.abs(I)),V=[E[0],E[1],I[0],I[1]],B=[E[2],E[3],I[2],I[3]],F=e.add(c(C(V),2),1),k=e.add(c(C(B),2),1),h=c(-1,w(N,[0,0,0,0])),A=e.add([V[0],V[2],V[1],V[3]],c([F[0],F[2],F[1],F[3]],[h[0],h[0],h[1],h[1]])),R=e.add([B[0],B[2],B[1],B[3]],c([k[0],k[2],k[1],k[3]],[h[2],h[2],h[3],h[3]])),T=[A[0],A[1],N[0]];l=[A[2],A[3],N[1]],b=[R[0],R[1],N[2]];let j=[R[2],R[3],N[3]],S=Y([e.dot(T,T),e.dot(l,l),e.dot(b,b),e.dot(j,j)]);T=c(T,S[0]),l=c(l,S[1]),b=c(b,S[2]),j=c(j,S[3]);let x=e.max([e.subtract(.5,[e.dot(r,r),e.dot(d,d),e.dot(y,y),e.dot(f,f)]),[0,0,0,0]],0);return x=c(x,x),x=c(x,x),c(105,e.dot(x,[e.dot(T,r),e.dot(l,d),e.dot(b,y),e.dot(j,f)]))},ut=(n,t,o)=>{let a=0,r=1,s=1,m=0;for(let i=0;i<o;i++)a+=Z(c(n,r))*s,m+=s,s*=t,r*=2;return a/m};export{P as decodeComponent,$ as getEntityIdFromKeys,st as getEvents,U as hexToAscii,G as parseComponentValue,q as parseComponentValueFromGraphQLEntity,ut as recursiveSNoise,J as setComponentFromEvent,W as setComponentFromGraphQLEntity,mt as setComponentsFromEvents,ct as setComponentsFromGraphQLEntities,pt as shortenHex,Z as snoise};
//# sourceMappingURL=index.js.map